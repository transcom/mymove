import React from 'react';
import { render, screen, act } from '@testing-library/react';

import ProfileTable from './ProfileTable';

import { ORDERS_BRANCH_OPTIONS } from 'constants/orders';

const testServiceMember = {
  affiliation: 'ARMY',
  backup_contacts: [
    {
      created_at: '2025-04-02T16:20:54.036Z',
      email: 'test@test.com',
      id: '951552ad-3796-465c-9199-7c4f47a11063',
      name: 'test test',
      permission: 'NONE',
      service_member_id: '71db5bbe-e319-429b-a7e1-b2c1c023f692',
      telephone: '222-312-4124',
      updated_at: '2025-04-02T16:20:54.036Z',
    },
  ],
  backup_mailing_address: {
    city: 'BEVERLY HILLS',
    county: 'LOS ANGELES',
    id: '48ef905b-c64f-46d9-88eb-7e022732464a',
    isOconus: false,
    postalCode: '90212',
    state: 'CA',
    streetAddress1: '123 Any Street',
    streetAddress2: 'P.O. Box 12345',
    streetAddress3: 'c/o Some Person',
    usPostRegionCitiesID: 'dfbd8c2d-c92d-465d-a5ac-9fda39401d00',
  },
  cac_validated: true,
  created_at: '2025-04-02T16:18:34.531Z',
  edipi: '1234567890',
  email_is_preferred: true,
  first_name: 'test',
  id: '71db5bbe-e319-429b-a7e1-b2c1c023f692',
  is_profile_complete: true,
  last_name: 'test',
  middle_name: '',
  orders: [
    {
      authorizedWeight: 5000,
      created_at: '2025-04-10T17:28:19.325Z',
      entitlement: {
        proGear: 2000,
        proGearSpouse: 500,
        ub_allowance: 0,
      },
      grade: 'E_1',
      has_dependents: false,
      id: '1c4f84f7-fdf7-4ecd-810b-84f5d6da1893',
      issue_date: '2025-04-03',
      moves: [
        {
          closeout_office: {
            address: {
              city: 'Scott AFB',
              county: 'SAINT CLAIR',
              id: 'dbb235ce-d27f-4b56-bc6b-cdb818355176',
              isOconus: false,
              postalCode: '62225',
              state: 'IL',
              streetAddress1: '215 Heritage Dr',
              streetAddress2: 'Bldg P-8, Room D-100',
              usPostRegionCitiesID: '1de25ff8-3ea6-4bf4-952b-3f1af1683d3e',
            },
            created_at: '2018-05-28T14:27:36.499Z',
            gbloc: 'AGFM',
            id: '0931a9dc-c1fd-444a-b138-6e1986b1714c',
            name: 'PPPO Scott AFB - USAF',
            phone_lines: [],
            updated_at: '2018-05-28T14:27:36.499Z',
          },
          created_at: '2025-04-10T17:28:19.332Z',
          eTag: 'MjAyNS0wNC0xMFQyMDoxNjoxMy42OTA2ODNa',
          id: 'd74ef1a4-1391-445b-bf9b-66db702a4c1f',
          locator: 'JXBQKM',
          orders_id: '1c4f84f7-fdf7-4ecd-810b-84f5d6da1893',
          primeCounselingCompletedAt: '0001-01-01T00:00:00.000Z',
          service_member_id: '71db5bbe-e319-429b-a7e1-b2c1c023f692',
          status: 'DRAFT',
          updated_at: '2025-04-10T20:16:13.690Z',
        },
      ],
      new_duty_location: {
        address: {
          city: 'Scott',
          county: 'PULASKI',
          id: 'e70d2973-28fd-45c6-950b-223816962088',
          isOconus: false,
          postalCode: '72142',
          state: 'AR',
          streetAddress1: 'n/a',
          usPostRegionCitiesID: 'd229f2f3-c002-4e13-a21c-7829a1973a83',
        },
        address_id: 'e70d2973-28fd-45c6-950b-223816962088',
        affiliation: null,
        created_at: '2025-04-02T16:17:06.159Z',
        id: '5515a499-2800-454e-8b5f-ba74d4d164dc',
        name: 'Scott, AR 72142',
        provides_services_counseling: true,
        updated_at: '2025-04-02T16:17:06.159Z',
      },
      orders_type: 'PERMANENT_CHANGE_OF_STATION',
      originDutyLocationGbloc: 'HAFC',
      origin_duty_location: {
        address: {
          city: 'Scott',
          county: 'PULASKI',
          id: 'e70d2973-28fd-45c6-950b-223816962088',
          isOconus: false,
          postalCode: '72142',
          state: 'AR',
          streetAddress1: 'n/a',
          usPostRegionCitiesID: 'd229f2f3-c002-4e13-a21c-7829a1973a83',
        },
        address_id: 'e70d2973-28fd-45c6-950b-223816962088',
        affiliation: null,
        created_at: '2025-04-02T16:17:06.159Z',
        id: '5515a499-2800-454e-8b5f-ba74d4d164dc',
        name: 'Scott, AR 72142',
        provides_services_counseling: true,
        updated_at: '2025-04-02T16:17:06.159Z',
      },
      providesServicesCounseling: true,
      report_by_date: '2025-04-22',
      service_member_id: '71db5bbe-e319-429b-a7e1-b2c1c023f692',
      spouse_has_pro_gear: false,
      status: 'DRAFT',
      updated_at: '2025-04-10T17:28:19.325Z',
      uploaded_orders: {
        id: '88d68cbd-9966-47d5-bf45-130515242930',
        service_member_id: '71db5bbe-e319-429b-a7e1-b2c1c023f692',
        uploads: [
          {
            bytes: 787096,
            contentType: 'image/png',
            createdAt: '2025-04-10T17:28:23.555Z',
            filename: 'Screenshot 2025-01-17 at 12.10.19 PM (2).png-20250410132823',
            id: '961fdfea-71fc-4e27-9ea1-f4e9ce93ad67',
            status: 'CLEAN',
            updatedAt: '2025-04-10T17:28:23.555Z',
            uploadType: 'USER',
            url: '/storage/user/e88fd621-6fe7-4d48-8bd2-8c27b8d9cbfc/uploads/961fdfea-71fc-4e27-9ea1-f4e9ce93ad67?contentType=image%2Fpng\u0026filename=Screenshot+2025-01-17+at+12.10.19%E2%80%AFPM+%282%29.png-20250410132823',
          },
        ],
      },
    },
    {
      created_at: '2025-04-02T17:05:14.485Z',
      department_indicator: 'AIR_AND_SPACE_FORCE',
      entitlement: {},
      grade: 'E_1',
      has_dependents: false,
      id: '9fca01be-a447-4387-8a34-a3f21779061e',
      issue_date: '2025-04-01',
      moves: [
        {
          created_at: '2025-04-02T17:05:14.489Z',
          eTag: 'MjAyNS0wNC0wN1QxNjoxNDoyNi4xMTI3MzFa',
          id: 'fe0b1f9c-f4a5-4808-ac51-73e94f15d138',
          locator: 'FDB7Y3',
          orders_id: '9fca01be-a447-4387-8a34-a3f21779061e',
          primeCounselingCompletedAt: '0001-01-01T00:00:00.000Z',
          service_member_id: '71db5bbe-e319-429b-a7e1-b2c1c023f692',
          status: 'DRAFT',
          submitted_at: '2025-04-07T16:14:26.099Z',
          updated_at: '2025-04-07T16:14:26.112Z',
        },
      ],
      new_duty_location: {
        address_id: '018084d1-8c53-4103-acc8-488db8c06eb9',
        affiliation: null,
        created_at: '2025-04-02T16:17:12.246Z',
        id: '450ce4e6-7ee7-4e24-aa15-d2fefa6cd7d8',
        name: 'Luke AFB, AZ 85309',
        provides_services_counseling: true,
        transportation_office: {
          address: null,
          created_at: '2018-05-28T14:27:39.198Z',
          gbloc: 'KKFA',
          id: '3210a533-19b8-4805-a564-7eb452afce10',
          name: 'PPPO Luke AFB - USAF',
          phone_lines: [],
          updated_at: '2018-05-28T14:27:39.198Z',
        },
        transportation_office_id: '3210a533-19b8-4805-a564-7eb452afce10',
        updated_at: '2025-04-02T16:17:12.246Z',
      },
      orders_number: '1111',
      orders_type: 'PERMANENT_CHANGE_OF_STATION',
      orders_type_detail: 'HHG_PERMITTED',
      originDutyLocationGbloc: 'AGFM',
      origin_duty_location: {
        address_id: '9bab26c6-81e0-416c-980a-f891604055ad',
        affiliation: 'AIR_FORCE',
        created_at: '2025-04-02T16:17:06.159Z',
        id: '70c957eb-54b6-42a3-8d87-fe4849e6e578',
        name: 'Scott AFB, IL 62225',
        provides_services_counseling: true,
        transportation_office_id: '0931a9dc-c1fd-444a-b138-6e1986b1714c',
        updated_at: '2025-04-02T16:17:06.159Z',
      },
      providesServicesCounseling: true,
      report_by_date: '2025-04-22',
      service_member_id: '71db5bbe-e319-429b-a7e1-b2c1c023f692',
      spouse_has_pro_gear: false,
      status: 'DRAFT',
      tac: '1111',
      updated_at: '2025-04-07T15:51:05.788Z',
      uploaded_orders: {
        id: 'b3123536-3d71-4498-8c1a-b0365e4fed6e',
        service_member_id: '71db5bbe-e319-429b-a7e1-b2c1c023f692',
        uploads: [
          {
            bytes: 171446,
            contentType: 'image/png',
            createdAt: '2025-04-02T17:05:18.765Z',
            filename: 'Screenshot 2025-01-23 at 4.47.34 PM.png-20250402130518',
            id: '9db37eb1-2205-4c79-9bb6-dec4071ff8fb',
            status: 'CLEAN',
            updatedAt: '2025-04-02T17:05:18.765Z',
            uploadType: 'USER',
            url: '/storage/user/e88fd621-6fe7-4d48-8bd2-8c27b8d9cbfc/uploads/9db37eb1-2205-4c79-9bb6-dec4071ff8fb?contentType=image%2Fpng\u0026filename=Screenshot+2025-01-23+at+4.47.34%E2%80%AFPM.png-20250402130518',
          },
        ],
      },
    },
    {
      created_at: '2025-04-02T16:23:13.810Z',
      department_indicator: 'AIR_AND_SPACE_FORCE',
      entitlement: {},
      grade: 'E_1',
      has_dependents: false,
      id: '691d67aa-f3e9-46b3-b17d-7e0cddbc0695',
      issue_date: '2025-04-01',
      moves: [
        {
          created_at: '2025-04-02T16:23:13.833Z',
          eTag: 'MjAyNS0wNC0wNFQxNjo0NDoyMi44Mzg3NzRa',
          id: 'c60b4144-cef6-43b7-a4b7-6c2b3e432fe4',
          locator: 'W86YBB',
          orders_id: '691d67aa-f3e9-46b3-b17d-7e0cddbc0695',
          primeCounselingCompletedAt: '0001-01-01T00:00:00.000Z',
          service_member_id: '71db5bbe-e319-429b-a7e1-b2c1c023f692',
          status: 'APPROVALS REQUESTED',
          submitted_at: '2025-04-02T16:26:52.556Z',
          updated_at: '2025-04-04T16:44:22.838Z',
        },
      ],
      new_duty_location: {
        address_id: '018084d1-8c53-4103-acc8-488db8c06eb9',
        affiliation: null,
        created_at: '2025-04-02T16:17:12.246Z',
        id: '450ce4e6-7ee7-4e24-aa15-d2fefa6cd7d8',
        name: 'Luke AFB, AZ 85309',
        provides_services_counseling: true,
        transportation_office: {
          address: null,
          created_at: '2018-05-28T14:27:39.198Z',
          gbloc: 'KKFA',
          id: '3210a533-19b8-4805-a564-7eb452afce10',
          name: 'PPPO Luke AFB - USAF',
          phone_lines: [],
          updated_at: '2018-05-28T14:27:39.198Z',
        },
        transportation_office_id: '3210a533-19b8-4805-a564-7eb452afce10',
        updated_at: '2025-04-02T16:17:12.246Z',
      },
      orders_number: '1111',
      orders_type: 'PERMANENT_CHANGE_OF_STATION',
      orders_type_detail: 'HHG_PERMITTED',
      originDutyLocationGbloc: 'HAFC',
      origin_duty_location: {
        address_id: 'e70d2973-28fd-45c6-950b-223816962088',
        affiliation: null,
        created_at: '2025-04-02T16:17:06.159Z',
        id: '5515a499-2800-454e-8b5f-ba74d4d164dc',
        name: 'Scott, AR 72142',
        provides_services_counseling: true,
        updated_at: '2025-04-02T16:17:06.159Z',
      },
      providesServicesCounseling: true,
      report_by_date: '2025-04-15',
      service_member_id: '71db5bbe-e319-429b-a7e1-b2c1c023f692',
      spouse_has_pro_gear: false,
      status: 'DRAFT',
      tac: '1111',
      updated_at: '2025-04-02T16:27:48.527Z',
      uploaded_orders: {
        id: '5aed2999-e981-417a-8cb0-dd6fb20a2508',
        service_member_id: '71db5bbe-e319-429b-a7e1-b2c1c023f692',
        uploads: [
          {
            bytes: 137589,
            contentType: 'image/png',
            createdAt: '2025-04-02T16:23:19.725Z',
            filename: 'Screenshot 2025-01-29 at 12.30.34 PM.png-20250402122319',
            id: '0384353c-783f-4312-8242-3a808ec0cf20',
            status: 'CLEAN',
            updatedAt: '2025-04-02T16:23:19.725Z',
            uploadType: 'USER',
            url: '/storage/user/e88fd621-6fe7-4d48-8bd2-8c27b8d9cbfc/uploads/0384353c-783f-4312-8242-3a808ec0cf20?contentType=image%2Fpng\u0026filename=Screenshot+2025-01-29+at+12.30.34%E2%80%AFPM.png-20250402122319',
          },
        ],
      },
    },
  ],
  personal_email: '20250402161834-8e931bda28fe@example.com',
  residential_address: {
    city: 'GARDENA',
    county: 'LOS ANGELES',
    id: 'c0234788-2ca3-4ca7-ae4a-f80843c64259',
    isOconus: false,
    postalCode: '90247',
    state: 'CA',
    streetAddress1: '123 Any Street',
    streetAddress2: 'P.O. Box 12345',
    streetAddress3: 'c/o Some Person',
    usPostRegionCitiesID: '4e704eb8-741a-4e71-b247-217834247025',
  },
  secondary_telephone: '',
  suffix: '',
  telephone: '222-312-4124',
  updated_at: '2025-04-07T15:51:05.781Z',
  user_id: 'e88fd621-6fe7-4d48-8bd2-8c27b8d9cbfc',
};

describe('Orders table', () => {
  it('renders the Profile table with disabled edit buttons when move is locked by office user', async () => {
    await act(() => {
      render(
        <ProfileTable
          affiliation={ORDERS_BRANCH_OPTIONS[testServiceMember?.affiliation] || ''}
          city={testServiceMember.residential_address.city}
          edipi={testServiceMember.edipi}
          email={testServiceMember.personal_email}
          firstName={testServiceMember.first_name}
          lastName={testServiceMember.last_name}
          postalCode={testServiceMember.residential_address.postalCode}
          state={testServiceMember.residential_address.state}
          streetAddress1={testServiceMember.residential_address.streetAddress1}
          streetAddress2={testServiceMember.residential_address.streetAddress2}
          streetAddress3={testServiceMember.residential_address?.streetAddress3 || ''}
          telephone={testServiceMember.telephone}
          isMoveLocked
        />,
      );
    });

    expect(screen.getByTestId('edit-profile-table')).toBeDisabled();
  });
});
