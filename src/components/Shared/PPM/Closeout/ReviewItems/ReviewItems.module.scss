@use 'shared/standardUI/' as *;
@use 'shared/standardUI/Buttons/mm_buttons' as *;
@use 'shared/standardUI/Layouts/breaks' as *;

.emptyWrapper > *{
    grid-column: 1 / span 2;
}

.review-wrapper{
    display: contents;

  .review-panel,
  .review-row,
  & > *:where(:not(button):not(.missingAlert)){
    @at-root (with: rule){
      display: contents;
    }
  }

  :where(* > .headingContent){
    display: grid;
    grid-auto-flow: column;
    grid-gap: 1rem;
    gap: 1rem;
    grid-column: 1;
    width: max-content;
    align-items: baseline;
    align-content: center;
  }

  :is(h2,h3,h4) {
    margin: 0;
    height: 1.5rem;
    grid-column: 1;
    white-space: nowrap;
  }

  .headingContainer{
      & ~ {
        a > button:first-of-type,
        button:first-of-type{
          width: min-content;
          grid-row: auto;

          @include mix-at-media($media-breaks-regular-exclusive) using ($selector, $media-break){
            grid-column: 1 / span 2;
          }
          @include mix-at-media($media-breaks-regular-exclusive) using ($selector, $media-break){
            grid-column: end / span 1;
            justify-self: end;
          }
        }
      }
  }

  .action-button-container{
    display: grid;
    gap: 1rem;
    height: min-content;

    @include mix-at-media($media-breaks-mobile, $media-breaks-tablet) using ($selector, $media-break){
      grid-template-rows: minmax(2rem, min-content) repeat(auto-fit, minmax(3rem, min-content));
      grid-column: 1 / span all;
      justify-content: stretch;
      grid-auto-flow: row;

    }
    @include mix-at-media($media-breaks-regular-exclusive) using ($selector, $media-break){
      grid-column: 4 / span 2;
      justify-self: end;
      grid-auto-flow: column;
    }

  }

  .headingContainer ~ {
    a button:first-of-type,
    button:first-of-type
  {
    @include mix-at-media($media-breaks-mobile, $media-breaks-tablet) using ($selector, $media-break){
      width: 100%;
      grid-column: 1 / span 2;
    }
  }
  }
  :where(.missingAlert){
    @include u-color('secondary-dark');
    @include u-font-weight(700);
    grid-column: 1 / span all;
    display: flex;
    gap: 1rem;
    align-items: center;
    > *:first-child {
      margin: unset;
    }

    .alertTag {
      width: 20px;
      height: 20px;
      @include u-bg('secondary-dark');
    }

  }


  .content-container{
      display: grid;
      grid-template-columns: min-content auto auto 1fr;
      grid-template-rows: repeat(auto-fit, minmax(1rem, min-content));
      grid-auto-rows: minmax(1rem, min-content);
      gap: 0.5rem 1rem;
      grid-column: 1 / span all;
      height: fit-content;
      @include u-radius(3px);
  }

  &:where(:not(:has(.w2Address))){
    gap: 1.5rem 0.5rem;

    .content-container{
      border: 0.07rem solid $base-lighter;
      border: 0.07rem solid #dfe1e2;
    padding: 1.5rem;
    grid-column: 1 / span 2;
    width: 100%;
      @include u-padding(3);
    }
  }

  &:has(.w2Address){
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    width: 100%;

    .content-container{
      @include mix-at-media($media-breaks-tablet,$media-breaks-mobile) using ($selector, $media-break){
        padding-bottom: 1.5rem;
      }
    }

    .review-description{
      @include mix-at-media($media-breaks-tablet,$media-breaks-mobile) using ($selector, $media-break){
        display: inline-block;
      }
    }

    .action-button-container {
      grid-row: 1;
      @include mix-at-media($media-breaks-regular-exclusive) using ($selector, $media-break){
        grid-column: start / 1;
      }
    }
  }

  .review-description{
    margin: 0;

    @include mix-at-media($media-breaks-regular-exclusive) using ($selector, $media-break){
      grid-column: 1 / span all;
      display: contents;
    }

    @include mix-at-media($media-breaks-tablet,$media-breaks-mobile) using ($selector, $media-break){
      grid-column: 1 / span all;
      display: contents;
    }

    &:after{
      content: '';
      display: block;
      height: 0rem;
      grid-column: 1 / span all;
      border-bottom: 1px solid #{$base-lighter};
    }
  }

  .review-description,
  .review-term{
    --grid-value: 0;

    .w2Address > :where(&){
      @include mix-at-media($media-breaks-regular-exclusive) using ($selector, $media-break){
        grid-row: span 2;
        align-self: end;
      }
      &:is(.review-description){
          display: inline-block;
        br:first-child:first-of-type{
          display: none;
        }
      }
    }

    :where(.w2Address > *:not(.review-description)){
      grid-column: 2;
      grid-row-end: span 2;
      justify-self: start;
    }

    @at-root :is(.subheading) {
      grid-row: span 2;
      & > * {
        white-space: nowrap;
      }
    }
  }

  .review-term{
    width: max-content;
    grid-column: 1;
  }

}

.ReviewItems {
  @include at-media-max(mobile-lg) {
    .headingContainer {
      @include u-display(block);

      .headingContent {
        @include u-display(block);

        h1,h2,h3,h4,h5,h6 {
          @include u-display(inline);
          @include u-margin-right(1);
        }
      }

      .addButtonContainer {
        @include u-display(block);
        @include u-padding-top(2);
        @include u-padding-bottom(1);

        a {
          @include u-margin-bottom(0);
          @include u-margin-right(0);
        }
      }
    }
  }

  @include at-media(mobile-lg) {
    .headingContainer {
      @include u-display(flex);
      @include u-align-items(align-end);

      .headingContent {
        @include u-flex(1);

        h1, h2, h3, h4, h5, h6 {
          @include u-display(inline);
          @include u-margin-right(1);
        }
      }

      .addButtonContainer {
        @include u-flex(auto);

        a {
          @include u-margin-bottom(0);
          @include u-margin-right(0);
        }
      }
    }
  }

  .missingAlert {
     @include u-margin-bottom(2);
     @include u-font-weight(700);
     @include u-color('secondary-dark');
     display: flex;

  }

  // .contentsContainer {
  //   .headingWrapper {
  //     @include u-border(1px, solid);
  //     @include u-radius(3px);
  //     border-color: $border-color;
  //     @include u-margin-top(2);
  //     @include u-padding(3);
  //   }

  //   .subheadingWrapper {
  //     @include u-margin-top(0);

  //     h1, h2, h3, h4, h5, h6, dl {
  //       @include u-margin-top(0);
  //     }

  //     .actionContainer {

  //       @include u-margin-top(0);
  //       @media(max-width: $mobile) {
  //         button {
  //           @include u-width(auto);
  //         }
  //       }
  //     }

  //     .emptyMessage {
  //       @include u-font-size('body', '3xs');
  //       color: $base;
  //     }
  //   }

  //   .emptyWrapper {
  //     @include u-border(1px, solid);
  //     @include u-radius(3px);
  //     border-color: $border-color;
  //     @include u-margin-top(2);
  //     @include u-padding(3);
  //   }

  //   .emptyMessage {
  //       @include u-font-size('body', '3xs');
  //       color: $base;
  //     }

  //   .subheading {
  //     @include u-margin-right(2);
  //   }

  //   dl {
  //     @include u-margin-bottom(0);
  //     @include u-flex(1);
  //     .w2Address {
  //       @include u-margin-top(2);
  //     }
  //   }

  //   .actionContainer {
  //     @include u-margin-top(2);

  //     a {
  //       @include u-font-size('body', 'xs');
  //     }

  //     .actionSeparator{
  //       @include u-margin-x(1);
  //     }
  //   }

  //   .hiddenTerm {
  //     @include u-display(none);
  //   }

  //   dt, dd {
  //     @include u-display(inline);
  //   }

  //   dd {
  //     @include u-margin-left(0);
  //   }

  //   dt {
  //     @include u-margin-right('05');
  //   }

  //   @include at-media-max(mobile-lg) {
  //     .subheadingWrapper {
  //       flex-wrap: wrap;

  //       .subheading {
  //         @include u-margin-right(0);
  //         flex-basis: 50%;
  //         flex-shrink: 0;
  //         order: 1;
  //       }

  //       dl {
  //         order: 3;
  //       }

  //       .actionContainer {
  //         text-align: right;
  //         flex-basis: 50%;
  //         flex-shrink: 0;
  //         order: 2;

  //         button {
  //           @include u-width(auto);
  //         }
  //       }
  //     }
  //   }
  // }

  :global(.usa-button--secondary:visited) {
    color: $primary;
  }

  :global(.usa-button--secondary:hover) {
    color: $primary-dark;
  }

  :global(.usa-button--secondary:hover) {
    text-decoration: none;
  }
}
