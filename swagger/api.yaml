swagger: '2.0'
info:
  description: The public API for my.move.mil. This is a work in-progress, and is not a final product. We will be continuously updating this site based on feedback.
  version: 0.0.1
  title: my.move.mil
  license:
    name: MIT
    url: https://github.com/transcom/mymove/blob/master/LICENSE.md
basePath: /api/v1
consumes:
  - application/json
produces:
  - application/json
definitions:
  Address:
    type: object
    properties:
      street_address_1:
        type: string
        example: 123 Main Ave
        title: Address Line 1
      street_address_2:
        type: string
        example: Apartment 9000
        x-nullable: true
        title: Address Line 2
      street_address_3:
        type: string
        example: Montm√¢rtre
        x-nullable: true
        title: Address Line 3
      city:
        type: string
        example: Anytown
        title: City
      state:
        title: State
        type: string
        example: CA
      postal_code:
        type: string
        description: zip code, international allowed
        format: zip
        title: ZIP/Postal Code
        example: "'90210' or 'N15 3NL'"
      country:
        type: string
        title: Country
        x-nullable: true
        example: "United States"
        default: United States
    required:
      - street_address_1
      - city
      - postal_code
  IndexBlackoutsPayload:
    type: array
    items:
      $ref: '#/definitions/BlackoutPayload'
  CreateBlackoutPayload:
    type: object
    properties:
      start_date:
        type: string
        description: the first day to blackout
        format: date
        example: 2018-10-21
      end_date:
        type: string
        description: the first day after the blackout ends
        format: date
        example: 2018-10-29
      gbloc:
        $ref: '#/definitions/GBLOC'
      zip3:
        type: string
        description: restricts the search to blackout periods with an explicit source rate area (zip3)
        example: 941
        pattern: '^[0-9]{3}$'
      channel:
        $ref: '#/definitions/Channel'
      market:
        $ref: '#/definitions/ShipmentMarket'
      code_of_service:
        $ref: '#/definitions/CodeOfService'
    required:
      - start_date
      - end_date
  BlackoutPayload:
    type: object
    properties:
      id:
        type: string
        description: unique id of the blackout in the system
        format: uuid
        example: c56a4180-65aa-42ec-a945-5fd21dec0538
      tsp_id:
        type: string
        description: ID of the TSP filing this blackout
        format: uuid
      start_date:
        type: string
        description: the first day to blackout
        format: date
        example: 2018-10-21
      end_date:
        type: string
        description: the first day after the blackout ends
        format: date
        example: 2018-10-29
      gbloc:
        $ref: '#/definitions/GBLOC'
      zip3:
        type: string
        description: restricts the search to blackout periods with an explicit source rate area (zip3)
        example: 941
        pattern: '^[0-9]{3}$'
      channel:
        $ref: '#/definitions/Channel'
      market:
        $ref: '#/definitions/ShipmentMarket'
      code_of_service:
        $ref: '#/definitions/CodeOfService'
    required:
      - start_date
      - end_date
  Channel:
    type: object
    description: The channel (pickup location & destination region)
    properties:
      origin:
        type: string
        enum: # Add other values
          - US49
        example: US49
      destination:
        type: string
        enum: # Add other values
          - REGION_6
        example: REGION_6
  Document:
    type: object
    description: A document is one or more uploaded files (usually images or PDFs) which can be associated with a shipment
    properties:
      id:
        type: string
        format: uuid
        description: Unique ID for this document within the system
        example: c56a4180-65aa-42ec-a945-5fd21dec0538
      name:
        type: string
        description: Human readable name for the document
        example: Preload Weight Ticket 2017-10-21
        maxLength: 1024
      uploads:
        type: array
        items:
          $ref: '#/definitions/DocumentUpload'
      created:
        type: string
        format: dateTime
        example: 2018-04-12T23:20:50.52Z
        description: When the document was created
      last_modified:
        type: string
        format: dateTime
        example: 2018-04-12T23:22:30.52Z
        description: When the document was last added to
      upload_url:
        type: string
        format: uri
        example: https://test_api.move.mil/api/v1/documents/c56a4180-65aa-42ec-a945-5fd21dec0538/uploads
        description: Location to which uploads should be posted.
    required:
      - name
  DocumentUpload:
    type: object
    description: Details of a file uploaded as part of a Document. Usually, but not always, an image or PDF
    properties:
      id:
        type: string
        format: uuid
        description: Unique ID for this object
        example: c56a4180-65aa-42ec-a945-5fd21dec0538
      name:
        type: string
        description: Human readable name for the document
        example: Page 3
        maxLength: 1024
      uploaded:
        type: string
        format: dateTime
        description: When the Upload was created
        example: 2018-04-12T23:22:30.52Z
      mime_type:
        type: string
        description: The mime type for the file
        example: 'application/pdf'
        enum:
          - application/pdf
          - image/jpeg
          - image/png
    required:
      - name
  Claim:
    type: object
    description: A claim resulting from an earlier shipment
    properties:
      id:
        type: string
        format: uuid
        example: c56a4180-65aa-42ec-a945-5fd21dec0538
      shipment_uuid:
        type: string
        format: uuid
        example: c56a4180-65aa-42ec-a945-5fd21dec0538
      claim_date:
        type: string
        format: dateTime
        example: 2018-04-12T23:20:50.52Z
      description:
        type: string
        example: "During shipment the Grandfather clock was dropped resulting in a break to the glass in front of the face"
  CodeOfService:
    type: string
    description: Code for service provided by a TSP
    enum:
      - COS_D
      - COS_2
      - COS_4
      - COS_5
      - COS_6
      - COS_T
      - COS_7
      - COS_8
      - COS_J
      - COS_B
      - COS_H
      - COS_S
    x-display-value:
      COS_D: Loose or containerized household goods CONUS
      COS_2: Moving household goods in containers CONUS
      COS_4: International Door to Door
      COS_5: International Door to Door Container Government Ocean Transport
      COS_6: International Door to Door Air Container
      COS_T: International Door to Door; Air Mobility Command (AMC)
      COS_7: International Land-Water-Land Baggage
      COS_8: International Land-Air-Land Baggage
      COS_J: International Land-Air (AMC)-Land Baggage
      COS_B: Tow-away boat
      COS_H: Haul-away boat
      COS_S: Mobile Home (CONUS)
  Customer:
    type: object
    description: The person moving
    properties:
      given_name:
        type: string
        example: Mary
      family_name:
        type: string
        example: Johnson
  GBLOC:
    type: string
    description: Office Codes for Transcom offices originating GBLs
    pattern: '^[A-Z]{4}$'
    example: LHNQ
  IndexShipments:
    type: array
    items:
      $ref: '#/definitions/Shipment'
  Move:
    type: object
    properties:
      selected_move_type:
        $ref: '#/definitions/SelectedMoveType'
      orders_id:
        type: string
        format: uuid
        example: c56a4180-65aa-42ec-a945-5fd21dec0538
      status:
        $ref: '#/definitions/MoveStatus'
      locator:
        type: string
        example: "12432"
      cancel_reason:
        type: string
        example: "Change of orders"
        x-nullable: true
    required:
      - orders_id
      - locator
  MoveStatus:
    type: string
    title: Move status
    enum:
      - DRAFT
      - SUBMITTED
      - APPROVED
      - COMPLETED
      - CANCELED
    x-display-value:
      DRAFT: Draft
      SUBMITTED: Submitted
      APPROVED: Approved
      COMPLETED: Completed
      CANCELED: Canceled
  SelectedMoveType:
    type: string
    title: Selected Move Type
    enum:
      - HHG
      - PPM
      - COMBO
    x-nullable: true
    x-display-value:
      HHG: Household Goods Move
      PPM: Personal Procured Move
      COMBO: Both HHG and PPM
  ServiceAgentRole:
    type: string
    title: Service Agent Role
    enum:
      - ORIGIN
      - DESTINATION
    x-display-value:
      ORIGIN: Origin
      DESTINATION: Destination
  ServiceMember:
    type: object
    properties:
      first_name:
        type: string
        example: John
        x-nullable: true
        title: First Name
      middle_name:
        type: string
        example: L.
        x-nullable: true
        title: Middle Name
      last_name:
        type: string
        example: Donut
        x-nullable: true
        title: Last Name
      suffix:
        type: string
        example: Jr.
        x-nullable: true
        title: Suffix
      telephone:
        type: string
        format: telephone
        pattern: '^[2-9]\d{2}-\d{3}-\d{4}$'
        example: 212-555-5555
        x-nullable: true
        title: Best Contact Phone
      secondary_telephone:
        type: string
        format: telephone
        pattern: '^[2-9]\d{2}-\d{3}-\d{4}$'
        example: 212-555-5555
        x-nullable: true
        title: Secondary Phone
      personal_email:
        type: string
        format: x-email
        pattern: '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
        example: john_bob@example.com
        x-nullable: true
        title: Personal Email Address
      phone_is_preferred:
        type: boolean
        x-nullable: true
        title: Telephone
      text_message_is_preferred:
        type: boolean
        x-nullable: true
        title: Text Message - Coming Soon!
      email_is_preferred:
        type: boolean
        x-nullable: true
        title: Email
  TrafficDistributionList:
    type: object
    properties:
      source_rate_area:
        type: string
        example: US34
      destination_region:
        type: string
        example: "5"
      code_of_service:
        type: string
        example: D
        enum:
          - D
          - "2"
    required:
      - source_rate_area
      - destination_region
      - code_of_service
  Shipment:
    type: object
    properties:
      id:
        type: string
        format: uuid
        example: c56a4180-65aa-42ec-a945-5fd21dec0538
        readOnly: true
      traffic_distribution_list:
        $ref: '#/definitions/TrafficDistributionList'
        readOnly: true
      service_member:
        $ref: '#/definitions/ServiceMember'
        readOnly: true
      pickup_date:
        type: string
        format: date-time
        example: 2018-04-21T17:32:28Z
      delivery_date:
        type: string
        format: date-time
        example: 2018-04-27T17:32:28Z
      created_at:
        type: string
        format: date-time
      updated_at:
        type: string
        format: date-time
      source_gbloc:
        $ref: '#/definitions/GBLOC'
        readOnly: true
      destination_gbloc:
        $ref: '#/definitions/GBLOC'
        readOnly: true
      market:
        $ref: '#/definitions/ShipmentMarket'
        readOnly: true
        x-nullable: true
      book_date:
        type: string
        format: date
        example: "2018-03-15"
      requested_pickup_date:
        type: string
        format: date-time
        example: 2018-04-19T17:32:28Z
      move:
        $ref: '#/definitions/Move'
        x-nullable: true
      status:
        $ref: '#/definitions/ShipmentStatus'
        readOnly: true
      estimated_pack_days:
        type: integer
        description: Estimated days packing
        minimum: 0
        example: 2
        x-nullable: true
      estimated_transit_days:
        type: integer
        description: Estimated days in transit
        minimum: 0
        example: 30
        x-nullable: true
      pickup_address:
        $ref: '#/definitions/Address'
        x-nullable: true
      has_secondary_pickup_address:
        type: boolean
        title: 'Do you have household goods at any other pickup location?'
      secondary_pickup_address:
        $ref: '#/definitions/Address'
        x-nullable: true
      has_delivery_address:
        type: boolean
        title: 'Do you know the delivery address at destination yet?'
      delivery_address:
        $ref: '#/definitions/Address'
        x-nullable: true
      has_partial_sit_delivery_address:
        type: boolean
      partial_sit_delivery_address:
        $ref: '#/definitions/Address'
        x-nullable: true
      weight_estimate:
        type: integer
        description: Estimated weight of the shipment in lbs
        minimum: 0
        example: 10000
        x-nullable: true
        x-formatting: weight
      progear_weight_estimate:
        type: integer
        description: Estimated weight of the progear in lbs
        minimum: 0
        example: 500
        x-nullable: true
        x-formatting: weight
      spouse_progear_weight_estimate:
        type: integer
        description: Estimated weight of the spouse progear in lbs
        minimum: 0
        example: 200
        x-nullable: true
        x-formatting: weight
      pm_survey_planned_pack_date:
        type: string
        format: date
        example: "2018-04-26"
        title: "Planned pack date"
        x-nullable: true
      pm_survey_planned_pickup_date:
        type: string
        format: date
        example: "2018-04-26"
        title: "Planned pickup date"
        x-nullable: true
      pm_survey_planned_delivery_date:
        type: string
        format: date
        example: "2018-04-26"
        title: "Planned delivery date"
        x-nullable: true
      pm_survey_weight_estimate:
        type: integer
        minimum: 0
        example: 10000
        title: Weight
        x-nullable: true
        x-formatting: weight
      pm_survey_progear_weight_estimate:
        type: integer
        minimum: 0
        example: 10000
        title: Pro-Gear weight
        x-nullable: true
        x-formatting: weight
      pm_survey_spouse_progear_weight_estimate:
        type: integer
        minimum: 0
        example: 10000
        title: Spouse's pro-gear
        x-nullable: true
        x-formatting: weight
      pm_survey_notes:
        type: string
        example: This document is good to go!
        x-nullable: true
        title: Notes
      pm_survey_method:
        type: string
        title: Survey method
        enum:
          - IN_PERSON
          - PHONE
          - VIDEO
        x-display-value:
          IN_PERSON: In person
          PHONE: Phone
          VIDEO: Video
  IndexServiceAgents:
    type: array
    items:
      $ref: '#/definitions/ServiceAgent'
  ServiceAgent:
    type: object
    properties:
      id:
        type: string
        format: uuid
        example: c56a4180-65aa-42ec-a945-5fd21dec0538
        readOnly: true
      shipment_id:
        type: string
        format: uuid
        example: c56a4180-65aa-42ec-a945-5fd21dec0538
      role:
        $ref: '#/definitions/ServiceAgentRole'
      point_of_contact:
        type: string
        example: John Doe at Acme Shipping
      email:
        type: string
        format: x-email
        pattern: '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
        description: Email used to contact shipping agent
        example: jackson_flies@gmail.com
        x-nullable: true
      phone_number:
        type: string
        format: telephone
        pattern: '^[2-9]\d{2}-\d{3}-\d{4}$'
        example: 212-555-1213
        x-nullable: true
      fax_number:
        type: string
        format: telephone
        pattern: '^[2-9]\d{2}-\d{3}-\d{4}$'
        example: 212-555-1213
        x-nullable: true
      email_is_preferred:
        type: boolean
        x-nullable: true
        title: Email
      phone_is_preferred:
        type: boolean
        x-nullable: true
        title: Telephone
      notes:
        type: string
        x-nullable: true
        example: This service agent is available at all hours
      created_at:
        type: string
        format: date-time
      updated_at:
        type: string
        format: date-time
    required:
      - role
      - point_of_contact
  ShipmentReject:
    type: object
    properties:
      reason:
        type: string
        example: We are overbooked and did not manage to file blackout dates in a timely fashion.
    required:
      - reason
  ShipmentContactDetails:
    type: object
    description: Contact details for customer for Shipment
    properties:
      primary_name:
        type: string
        description: Name of the primary contact person
        example: Mike Jackson
      primary_title:
        type: string
        example: Lt. Colonel
        description: title of primary contact
      primary_phone:
        type: string
        format: telephone
        pattern: '^[2-9]\d{2}-\d{3}-\d{4}$'
        example: 212-555-1212
      primary_email:
        type: string
        format: x-email
        pattern: '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
        description: Email of primary contact person
        example: mjackson@gmail.com
      secondary_name:
        type: string
        example: Mary Jackson
      secondary_title:
        type: string
        example: Wing Commander
      secondary_phone:
        type: string
        format: telephone
        pattern: '^[2-9]\d{2}-\d{3}-\d{4}$'
        example: 212-555-1213
      secondary_email:
        type: string
        format: x-email
        pattern: '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
        description: Email of secondary contact person
        example: jackson_flies@gmail.com
  ShipmentDates:
    type: object
    description: The various dates associated with a shipment
    properties:
      requested_pack:
        type: string
        format: date
        example: 2018-03-15
      requested_pickup:
        type: string
        format: date
        example: 2018-03-15
      requested_latest_pickup:
        type: string
        format: date
        example: 2018-03-15
      requested_delivery:
        type: string
        format: date
        example: 2018-03-15
      planned_pack:
        type: string
        format: date
        example: 2018-03-15
      planned_pickup:
        type: string
        format: date
        example: 2018-03-15
      planned_latest_pickup:
        type: string
        format: date
        example: 2018-03-15
      planned_delivery:
        type: string
        format: date
        example: 2018-03-15
      scheduled_delivery:
        type: string
        format: date
        example: 2018-03-15
      required_delivery:
        type: string
        format: date
        example: 2018-03-15
      actual_pack:
        type: string
        format: date
        example: 2018-03-15
      actual_pickup:
        type: string
        format: date
        example: 2018-03-15
      actual_delivery:
        type: string
        format: date
        example: 2018-03-15
  ShipmentMarket:
    type: string
    description: One of the possible 'Markets' for a shipment
    example: dHHG
    enum:
      - dHHG
      - iHHG
      - iUB
    x-display-value:
      dHHG: Domestic HHG
      iHHG: International HHG
      iUB: International unaccompanied baggage
  ShipmentStatus:
    type: string
    description: The stages in the lifecycle of a Shipment
    example: IN_PROGRESS
    enum: &SHIPMENTSTATUS
      - AWARDED
      - ACCEPTED
      - REJECTED
      - IN_PROGRESS
      - IN_TRANSIT
      - DELIVERED
      - COMPLETED
      - CANCELED
    x-display-value:
      AWARDED: Awarded
      ACCEPTED: Accepted
      REJECTED: Rejected
      IN_PROGRESS: In Progress
      IN_TRANSIT: In Transit
      DELIVERED: Delivered
      COMPLETED: Completed
      CANCELED: Canceled
  TSP:
    type: object
    description: The primary definition of a Transport Service Provider
    properties:
      id:
        type: string
        format: uuid
        example: c56a4180-65aa-42ec-a945-5fd21dec0538
      name:
        type: string
        example: Moving Company, Inc.
        minLength: 1
        maxLength: 1024
      scac:
        type: string
        description: The SCAC associated with the TSP
        format: '^[A-Z]{2,4}$'
        example: USPS
      contact_email:
        type: string
        format: x-email
        pattern: '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
        example: john_bob@example.com
paths:
  /blackouts:
    get:
      summary: retrieve a list of blacked out dates (for accessible TSPs)
      description: Gets a list of blackout periods which the current user can see
      operationId: indexBlackouts
      tags:
        - blackouts
      parameters:
        - in: query
          name: start_date
          type: string
          format: date
          description: restricts the search to blackout periods for which the endDate is after this date
        - in: query
          name: end_date
          type: string
          format: date
          description: restricts the search to blackout periods which startDate is before this date
        - in: query
          name: gbloc
          type: string
          description: restricts the search to return blackout periods which originate from this GBLOC
          pattern: '^[A-Z]{4}$'
        - in: query
          name: source_service_area
          type: string
          description: restricts the search to blackout periods with an explicit source rate area (zip3)
      responses:
        200:
          description: list of associated blackouts
          schema:
            $ref: '#/definitions/IndexBlackoutsPayload'
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        500:
          description: server error
    post:
      summary: Adds a new Blackout period to the list of blackouts
      description: This is used to create a new blackout. When posting to this URL the payload Blackout should not
       contain an ID as this will be created when it is added to the DB.  Supplying this fields in the payload will
       result in a 400 bad request. The TSP ID will be inferred from the authenticated account making the request.

       At least one of GBLOC, zip3, Channel/COS or Market must be supplied. If more than one of these fields are supplied
       they will be AND'd together, i.e. GBLOC, Channel will restrict to shipments in the particular Channel which
       originate in the given GBLOC.
      operationId: createBlackout
      tags:
        - blackouts
      x-access: Access to this endpoint is restricted to members of the Admin, Transcom and JPPSO user groups along with the agents of the TSP.
      parameters:
        - in: body
          description: The blackout period to add
          name: payload
          required: true
          schema:
            $ref: '#/definitions/CreateBlackoutPayload'
      responses:
        201:
          description: The blackout as added to the database including DB ID
          schema:
            $ref: '#/definitions/BlackoutPayload'
        400:
          description: invalid request
        403:
          description: not authorized to create blackouts
        500:
          description: server error
  /blackouts/{blackout_uuid}:
    get:
      summary: retrieve the details of a blackout period
      operationId: getBlackout
      tags:
        - blackouts
      parameters:
        - in: path
          name: blackout_uuid
          type: string
          format: uuid
          required: true
          description: the unique identifier for the blackout
      responses:
        200:
          description: the details of the requested blackout period
          schema:
              $ref: '#/definitions/BlackoutPayload'
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to access the associated blackout
        404:
          description: no blackout found with that UUID
        500:
          description: server error
    patch:
      summary: update the associated blackout
      operationId: updateBlackout
      tags:
        - blackouts
      parameters:
        - in: path
          name: blackout_uuid
          type: string
          format: uuid
          required: true
          description: the unique identifier for the blackout
        - in: body
          name: update
          required: true
          schema:
            $ref: '#/definitions/BlackoutPayload'
      responses:
        200:
          description: the blackout was successfully updated
          schema:
              $ref: '#/definitions/BlackoutPayload'
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to access the associated blackout
        404:
          description: no blackout found with that UUID
        500:
          description: server error
    delete:
      summary: delete the associated blackout period
      operationId: deleteBlackout
      tags:
        - blackouts
      parameters:
        - in: path
          name: blackout_uuid
          type: string
          format: uuid
          required: true
          description: the unique identifier for the blackout
      responses:
        200:
          description: the blackout was successfully deleted
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to access the associated blackout
        404:
          description: no blackout found with that UUID
        500:
          description: server error
  /documents/{document_uuid}/uploads:
    post:
      summary: Adds a new upload to a document
      description: Uploads represent a single digital file, such as a JPEG or PDF.
      operationId: createDocumentUpload
      tags:
        - documents
      consumes:
        - multipart/form-data
      parameters:
        - in: path
          name: document_uuid
          type: string
          format: uuid
          required: true
          description: UUID of the document to which the Upload is added
        - in: formData
          name: file
          type: file
          description: The file to upload.
          required: true
        - in: formData
          name: name
          type: string
          description: Human readable name for the upload
      responses:
        201:
          description: created upload
          schema:
            $ref: '#/definitions/DocumentUpload'
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to see the details of this shipment
        404:
          description: dcoument UUID not found in system
        500:
          description: server error
  /shipments:
    get:
      summary: Gets visible shipments
      description: Allows a user to retrieve a list of shipments. The shipments are restricted to those they have authorization to view
      operationId: indexShipments
      tags:
        - shipments
      parameters:
        - name: status
          in: query
          type: array
          items:
            type: string
            enum: *SHIPMENTSTATUS
          collectionFormat: csv
          description: Restrict the list to shipments with matching ShipmentStatus
        - name: order_by
          in: query
          type: string
          description: Sort the returned list according to this ordering
          enum:
            - PICKUP_DATE_ASC
            - PICKUP_DATE_DESC
            - DELIVERY_DATE_ASC
            - DELIVERY_DATE_DESC
        - name: limit
          in: query
          type: integer
          description: maximum number of records to return
          minimum: 1
          default: 25
        - name: offset
          in: query
          type: integer
          description: offset into records to select from. Actual offset is this value multiplied by limit.
          minimum: 1
          default: 1
      responses:
        200:
          description: returns an array of Shipments
          schema:
            $ref: '#/definitions/IndexShipments'
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to list these shipments
        422:
          description: cannot process request with given information
        500:
          description: server error
  /shipments/{shipment_uuid}:
    get:
      summary: Gets a particular shipment
      description: Allows a user to retrieve the details of a particular shipment
      operationId: getShipment
      tags:
        - shipments
      parameters:
        - name: shipment_uuid
          in: path
          type: string
          format: uuid
          required: true
          description: UUID of the shipment
      responses:
        200:
          description: returns the details of the shipment
          schema:
            $ref: '#/definitions/Shipment'
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to see the details of this shipment
        404:
          description: shipment UUID not found in system
        500:
          description: server error
    patch:
      summary: Updates a particular shipment
      description: Takes a partial Shipment object and replaces the fields in the DB with the ones passed in the body
      operationId: patchShipment
      tags:
        - shipments
      parameters:
        - name: shipment_uuid
          in: path
          type: string
          format: uuid
          required: true
          description: UUID of the shipment
        - name: update
          in: body
          required: true
          schema:
            $ref: '#/definitions/Shipment'
      responses:
        200:
          description: returns the details of the shipment
          schema:
            $ref: '#/definitions/Shipment'
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to update the details of this shipment
        404:
          description: shipment UUID not found in system
        500:
          description: server error
  /shipments/{shipmentId}/service_agents:
    get:
      summary: Gets service agents for shipment
      description: Allows a user to retrieve a list of service agents for a shipment.
      operationId: indexServiceAgents
      tags:
        - service_agents
      parameters:
        - name: shipmentId
          in: path
          type: string
          format: uuid
          required: true
          description: UUID of the shipment
      responses:
        200:
          description: returns an array of Service Agents
          schema:
            $ref: '#/definitions/IndexServiceAgents'
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to list these shipments
        422:
          description: cannot process request with given information
        500:
          description: server error
    post:
      summary: Create a Service Agent
      description: Creates a new Service Agent associated with a shipment
      operationId: createServiceAgent
      tags:
        - service_agents
      parameters:
        - name: shipmentId
          in: path
          type: string
          format: uuid
          required: true
          description: UUID of the shipment
        - name: serviceAgent
          in: body
          required: true
          description: Service Agent information
          schema:
            $ref: '#/definitions/ServiceAgent'
      responses:
        200:
          description: returns a Service Agent with UUID.
          schema:
            $ref: '#/definitions/ServiceAgent'
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to add documents to this shipment
        500:
          description: server error
  /shipments/{shipmentId}/service_agents/{serviceAgentId}:
    patch:
      summary: Updates a particular service agent
      description: Takes a partial service agent object and replaces the fields in the DB with the ones passed int he body
      operationId: updateServiceAgent
      tags:
        - service_agents
      parameters:
        - name: shipmentId
          in: path
          type: string
          format: uuid
          required: true
          description: UUID of the shipment
        - name: serviceAgentId
          in: path
          type: string
          format: uuid
          required: true
          description: UUID of the service agent
        - name: payload
          in: body
          required: true
          description: Service Agent information
          schema:
            $ref: '#/definitions/ServiceAgent'
      responses:
        200:
          description: returns the details of the service agent
          schema:
            $ref: '#/definitions/ServiceAgent'
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to update the details of this service agent
        404:
          description: service agent UUID not found in system
        500:
          description: server error
    delete:
      summary: delete the service agent related to the shipment
      operationId: deleteServiceAgent
      tags:
        - service_agents
      parameters:
        - in: path
          name: shipmentId
          type: string
          format: uuid
          required: true
          description: the unique identifier for the shipment
        - in: path
          name: serviceAgentId
          type: string
          format: uuid
          required: true
          description: the unique identifier for the service_agent
      responses:
        200:
          description: the service agent was successfully deleted
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to access the associated service agent
        404:
          description: no service agent found with that UUID
        500:
          description: server error
  /shipments/{shipmentId}/accept:
    post:
      summary: Accepts an awarded shipment
      description: Accepts a shipment awarded to a TSP. The status of the shipment will be updated to ACCEPTED.
      operationId: createShipmentAccept
      tags:
        - shipments
      parameters:
        - name: shipmentId
          in: path
          type: string
          format: uuid
          required: true
          description: UUID of the shipment
      responses:
        200:
          description: returns updated (accepted) shipment object
          schema:
            $ref: '#/definitions/Shipment'
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to accept this shipment
        409:
          description: the shipment is not in a state to be accepted
          schema:
            $ref: '#/definitions/Shipment'
        500:
          description: server error
  /shipments/{shipmentId}/claims:
    get:
      summary: Gets the list of claims associated with a shipment
      operationId: getShipmentClaims
      tags:
        - shipments
      parameters:
        - name: shipmentId
          in: path
          type: string
          format: uuid
          required: true
          description: UUID of the shipment for which contact details are requested
      responses:
        200:
          description: returns contact details for the shipment
          schema:
            type: array
            items:
              $ref: '#/definitions/Claim'
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to access this shipment
        500:
          description: server error
  /shipments/{shipmentId}/contact_details:
    get:
      summary: Gets the detailed contact information for a move
      description: Accepts a shipment awarded to a TSP
      operationId: getShipmentContactDetails
      tags:
        - shipments
      parameters:
        - name: shipmentId
          in: path
          type: string
          format: uuid
          required: true
          description: UUID of the shipment for which contact details are requested
      responses:
        200:
          description: returns contact details for the shipment
          schema:
            $ref: '#/definitions/ShipmentContactDetails'
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to access this shipment
        500:
          description: server error
  /shipments/{shipmentId}/documents:
    get:
      summary: Gets the list of documents associated with a Shipment
      operationId: getShipmentDocuments
      tags:
        - shipments
      parameters:
        - name: shipmentId
          in: path
          type: string
          format: uuid
          required: true
          description: UUID of the shipment
      responses:
        200:
          description: returns the documents associated with the shipment
          schema:
            $ref: '#/definitions/Document'
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to access this shipment
        500:
          description: server error
    post:
      summary: Creates a new document associated with a shipment
      description: Creates the storage for the new document and sets the UUID
      operationId: createShipmentDocument
      tags:
        - shipments
      parameters:
        - name: shipmentId
          in: path
          type: string
          format: uuid
          required: true
          description: UUID of the shipment
        - name: payload
          in: body
          required: true
          description: A bare bones Document object containing the name of the new document
          schema:
            $ref: '#/definitions/Document'
      responses:
        200:
          description: returns updated document with UUID and create time set.
          schema:
            $ref: '#/definitions/Document'
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to add documents to this shipment
        500:
          description: server error
  /shipments/{shipmentId}/reject:
    post:
      summary: Rejects an awarded shipment
      description: Rejects a shipment awarded to a TSP. The status of the shipment will be updated to REJECTED.
      operationId: createShipmentReject
      tags:
        - shipments
      parameters:
        - name: shipmentId
          in: path
          type: string
          format: uuid
          required: true
          description: UUID of the shipment
        - name: payload
          in: body
          description: reason for refusing award
          required: true
          schema:
            $ref: '#/definitions/ShipmentReject'
      responses:
        200:
          description: returns updated (rejected) shipment object
          schema:
            $ref: '#/definitions/Shipment'
        400:
          description: invalid request
        401:
          description: must be authenticated to use this endpoint
        403:
          description: not authorized to reject this shipment
        409:
          description: the shipment is not in a state to be rejected
          schema:
            $ref: '#/definitions/Shipment'
        500:
          description: server error
  /tsps:
    get:
      summary: List all TSPs
      description: Gets a list of all the TSPs which the logged in user has access to.
      operationId: indexTSPs
      tags:
        - tsps
      x-access: Access to this endpoint is restricted to members of the Admin, Transcom & JPPSO user groups
      responses:
        200:
          description: list of TSPs
          schema:
            type: array
            items:
              $ref: '#/definitions/TSP'
        400:
          description: invalid request
        401:
          description: must be authenticated to access this endpoint
        500:
          description: server error
  /tsps/{tsp_uuid}/shipments:
    get:
      summary: Retrieve shipments associated with a TSP
      description: Gets a list of all shipments associated with a TSP. Shipments can be restricted to be in a certain state, e.g. AWARDED
      operationId: getTspShipments
      tags:
        - tsps
      x-access: Access to this endpoint is restricted to members of the Admin, Transcom and JPPSO user groups along with the agents of the TSP.
      parameters:
        - in: path
          name: tsp_uuid
          type: string
          format: uuid
          required: true
          description: UUID of the TSP
        - name: status
          in: query
          type: string
          required: false
          description: Status of shipments to load, e.g. AWARDED
        - name: order_by
          in: query
          type: string
          description: Sort the returned list according to this ordering
          enum:
            - PICKUP_DATE_ASC
            - PICKUP_DATE_DESC
            - DELIVERY_DATE_ASC
            - DELIVERY_DATE_DESC
        - name: limit
          in: query
          type: integer
          description: maximum number of records to return
          default: 25
        - name: offset
          in: query
          type: integer
          description: offset into records to begin selection from.
          default: 0
      responses:
        200:
          description: list of associated shipments
          schema:
            type: array
            items:
              $ref: '#/definitions/Shipment'
        400:
          description: invalid request
        403:
          description: not authorized to get list of shipments for this TSP
        404:
          description: TSP UUID not found in system
        500:
          description: server error
  /tsps/{tsp_uuid}/blackouts:
    get:
      summary: Retrieve a list of the blackouts associated with a TSP
      description: Gets a list of all blackouts associated with a TSP. Blackouts retrieved can be restricted by one or more
      operationId: getTspBlackouts
      tags:
        - tsps
      x-access: Access to this endpoint is restricted to members of the Admin, Transcom and JPPSO user groups along with the agents of the TSP.
      parameters:
        - in: path
          name: tsp_uuid
          type: string
          format: uuid
          required: true
          description: UUID of the TSP
        - in: query
          name: start_date
          type: string
          format: date
          description: restricts the search to blackout periods for which the endDate is after this date
        - in: query
          name: end_date
          type: string
          format: date
          description: restricts the search to blackout periods which startDate is before this date
        - in: query
          name: gbloc
          description: restricts the search to return blackout periods which originate from this GBLOC
          type: string
          pattern: '^[A-Z]{4}$'
        - in: query
          name: source_service_area
          type: string
          description: restricts the search to blackout periods with and explicit source service area
      responses:
        200:
          description: list of associated blackouts
          schema:
            type: array
            items:
              $ref: '#/definitions/BlackoutPayload'
        400:
          description: invalid request
        403:
          description: not authorized to get list of blackouts for this TSP
        404:
          description: TSP UUID not found in system
        500:
          description: server error
